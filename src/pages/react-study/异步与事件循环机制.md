<!--
 * @Author: Jitonghuan 2016670689@qq.com
 * @Date: 2023-02-09 16:58:50
 * @LastEditors: Jitonghuan 2016670689@qq.com
 * @LastEditTime: 2023-02-09 16:58:51
 * @FilePath: /my_umi4_course/src/pages/react-study/异步与事件循环机制.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->

1、事件循环机制
## 工作线程将消息放到消息队列，主线程通过事件循环过程去取消息
消息队列：消息队列是一个先进先出的队列，它里面存放着各种消息。

2、事件循环：事件循环是指主线程重复从消息队列中取消息、执行的过程。
### 消息就是注册异步任务时添加的回调函数。
### 消息队列中的每条消息实际上都对应着一个事件。
// 消息队列中的消息就长这个样子
var message = function () {
    callbackFn(response);
}
其中的callbackFn就是得到成功响应时的回调函数。

### 实际上，主线程只会做一件事情，就是从消息队列里面取消息、执行消息，再取消息、再执行。当消息队列为空时，就会等待，直到消息队列变成非空。而且主线程只有在将当前的消息执行完成后，才会去取下一个消息。这种机制就叫做事件循环机制，取一个消息并执行的过程叫做一次循环。

从生产者与消费者的角度看，异步过程是这样的：

工作线程是生产者，主线程是消费者(只有一个消费者)。工作线程执行异步任务，执行完成后把对应的回调函数封装成一条消息放到消息队列中；主线程不断地从消息队列中取消息并执行，当消息队列空时主线程阻塞，直到消息队列再次非空。
while(true) {
    var message = queue.get();
    execute(message);
}

## 异步过程的回调函数，一定不在当前这一轮事件循环中执行；
## 同步可以保证顺序一致，但是容易导致阻塞；异步可以解决阻塞问题，但是会改变顺序性。


